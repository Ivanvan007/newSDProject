const fs = require('fs');
const path = require('path');

class SimpleLogger {
  constructor(port) {
    this.port = port;
    this.logDir = path.join(__dirname, '../../../log');
    if (!fs.existsSync(this.logDir)) {
      fs.mkdirSync(this.logDir);
    }
    this.logFile = path.join(this.logDir, `server-${port}.log`);
  }

  log(level, message) {
    const timestamp = new Date().toISOString();
    const logMessage = `${timestamp} [${level.toUpperCase()}] ${message}`;
    console.log(logMessage);
    fs.appendFileSync(this.logFile, `${logMessage}\n`);
  }

  info(message) {
    this.log('info', message);
  }

  error(message) {
    this.log('error', message);
  }
}

const createLogger = (port) => {
  return new SimpleLogger(port);
};



module.exports = SimpleLogger;
